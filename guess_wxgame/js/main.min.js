var egret=window.egret,__reflect=this&&this.__reflect||function(t,e,n){t.__class__=e,n?n.push(e):n=[e],t.__types__=t.__types__?n.concat(t.__types__):n},__extends=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);n.prototype=e.prototype,t.prototype=new n},__awaiter=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(i,r){function s(t){try{l(o.next(t))}catch(e){r(e)}}function a(t){try{l(o["throw"](t))}catch(e){r(e)}}function l(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(s,a)}l((o=o.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function n(t){return function(e){return o([t,e])}}function o(n){if(i)throw new TypeError("Generator is already executing.");for(;l;)try{if(i=1,r&&(s=r[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(r,n[1])).done)return s;switch(r=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return l.label++,{value:n[1],done:!1};case 5:l.label++,r=n[1],n=[0];continue;case 7:n=l.ops.pop(),l.trys.pop();continue;default:if(s=l.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){l=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){l.label=n[1];break}if(6===n[0]&&l.label<s[1]){l.label=s[1],s=n;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(n);break}s[2]&&l.ops.pop(),l.trys.pop();continue}n=e.call(t,l)}catch(o){n=[6,o],r=0}finally{i=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,r,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},guess;!function(t){var e=function(t){function e(e,n){void 0===e&&(e="guess");var o=t.call(this)||this,i=o;return i.registerComponents(),i.initUI(e,n),i.addEventListeners(),o}return __extends(e,t),e.prototype.dispose=function(){t.prototype.dispose.call(this);var e=this;e.removeEventListeners(),utils.StageUtils.removeEventListener(egret.Event.RESIZE,e.setResolution,e)},e.prototype.initUI=function(t,e){var n=this;e&&""!=e||(e=egret.getQualifiedClassName(n),-1!=e.indexOf(".")&&(e=e.split(".")[1])),n.contentPane=fairygui.UIPackage.createObject(t,e).asCom},e.prototype.addEventListeners=function(){var t=this;utils.StageUtils.addEventListener(egret.Event.RESIZE,t.setResolution,t)},e.prototype.removeEventListeners=function(){var t=this;utils.StageUtils.removeEventListener(egret.Event.RESIZE,t.setResolution,t)},e.prototype.registerComponents=function(){},e.prototype.registerComponent=function(t,e,n){var o=fairygui.UIPackage.getItemURL(n,t);fairygui.UIObjectFactory.setPackageItemExtension(o,e)},e.prototype.onInit=function(){console.log("onInit")},e.prototype.onShown=function(){console.log("onShown")},e.prototype.setResolution=function(){var t=this;t.height=utils.StageUtils.stageHeight,t.width=utils.StageUtils.stageWidth},e}(fairygui.Window);t.BaseWindow=e,__reflect(e.prototype,"guess.BaseWindow")}(guess||(guess={}));var guess;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.constructFromResource=function(){t.prototype.constructFromResource.call(this);var e=this;e.txtChar=e.getChild("txtChar").asTextField,e.colorMask=e.getChild("color").asGraph},Object.defineProperty(e.prototype,"word",{get:function(){return this.txtChar.text},enumerable:!0,configurable:!0}),e.prototype.setChar=function(t){var e=this;e.txtChar.text=t,e.show()},e.prototype.hide=function(){var t=this;t.txtChar.alpha=0,t.removeColorAni()},e.prototype.show=function(){var t=this;t.txtChar.alpha=1},e.prototype.isEmpty=function(){return""==this.txtChar.text||0==this.txtChar.alpha},e.prototype.showColorAni=function(t){void 0===t&&(t=-1);var e=this;t>=0&&(e.colorMask.color=t),e.colorMask.alpha=0,egret.Tween.get(e.colorMask,{loop:!0}).to({alpha:1},500,egret.Ease.sineInOut).to({alpha:0},500,egret.Ease.sineInOut)},e.prototype.removeColorAni=function(){var t=this;t.colorMask.alpha=0,egret.Tween.removeTweens(t.colorMask)},e}(fairygui.GComponent);t.WordItem=e,__reflect(e.prototype,"guess.WordItem")}(guess||(guess={}));var guess;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this);var t=this;t.btnTask.removeClickListener(t.onbtnTask,t),t.btnClose.removeClickListener(t.onClose,t)},n.prototype.initUI=function(){var t=this;t.contentPane=fairygui.UIPackage.createObject("guess","LackGoldWindow").asCom},n.prototype.onInit=function(){var t=this;t.btnTask=t.contentPane.getChild("btnTask").asButton,t.btnTask.addClickListener(t.onbtnTask,t),t.btnClose=t.contentPane.getChild("btnClose").asButton,t.btnClose.addClickListener(t.onClose,t),t.txtTip=t.contentPane.getChild("txtTip").asTextField},n.prototype.initData=function(){var e=this;utils.Singleton.get(t.AdMgr).adEnable?e.txtTip.text="观看视频广告可解锁答案":e.txtTip.text="分享到群可解锁答案"},n.prototype.onbtnTask=function(e){var n=this;utils.Singleton.get(t.AdMgr).adEnable?utils.Singleton.get(t.AdMgr).watchAd(function(){n.hide(),utils.EventDispatcher.getInstance().dispatchEvent("watchAdOk")},function(){}):(utils.EventDispatcher.getInstance().dispatchEvent("shareGroupOk"),n.hide())},n.prototype.onClose=function(t){var e=this;e.hide()},n}(t.BaseWindow);t.LackGoldWindow=e,__reflect(e.prototype,"guess.LackGoldWindow")}(guess||(guess={}));var Main=function(t){function e(){var e=t.call(this)||this;return platform.isRunInWX()&&wx.loadFont("resource/RubikOne-Regular.ttf"),e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){egret.lifecycle.addLifecycleListener(function(t){t.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause(),utils.EventDispatcher.getInstance().dispatchEvent("onAppPause")},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,n,o;return __generator(this,function(i){switch(i.label){case 0:return[4,this.loadResource()];case 1:return i.sent(),[4,platform.login()];case 2:return i.sent(),t=e,[4,platform.getSystemInfo()];case 3:return t.systemInfo=i.sent(),[4,platform.getSetting()];case 4:return n=i.sent(),e.isScopeUserInfo=n.authSetting["scope.userInfo"],this.createGameScene(),[4,platform.getUserInfo()];case 5:return o=i.sent(),console.log(o),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,RES.loadGroup("preload",0,t)];case 2:return n.sent(),this.stage.removeChild(t),platform.openDataContext.postMessage({command:"loadRes"}),[3,4];case 3:return e=n.sent(),console.error(e),[3,4];case 4:return[2]}})})},e.prototype.createGameScene=function(){if(platform.isRunInWX()){var t=e.systemInfo.windowWidth/utils.StageUtils.stageWidth*376,n=e.systemInfo.windowHeight/utils.StageUtils.stageHeight*178;e.userInfoBtn=wx.createUserInfoButton({type:"image",image:"resource/assets/startBtn.png",style:{left:.5*e.systemInfo.windowWidth-.5*t,top:.5*e.systemInfo.windowHeight,width:t,height:n}}),e.userInfoBtn.onTap(function(t){"getUserInfo:ok"==t.errMsg&&(utils.EventDispatcher.getInstance().dispatchEvent("onClickStartBtn"),e.userInfoBtn.hide())})}fairygui.UIPackage.addPackage("guess"),this.stage.addChild(fairygui.GRoot.inst.displayObject),this.stage.removeChild(this);var o=new guess.MainWindow("guess");o.show(),wx.onShareAppMessage(function(){return{title:"转发标题"}})},e}(egret.DisplayObjectContainer);__reflect(Main.prototype,"Main");var DebugPlatform=function(){function t(){}return t.prototype.isRunInWX=function(){return!1},t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.getSetting=function(){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(e){return t={},t.authSetting={},[2,t]})})},t.prototype.getSystemInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,null]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var guess;!function(t){var e=function(){function e(){}return e.prototype.onCreate=function(){var e=this;e.data={},e.data.gold=0,e.data.reachLevel=1,e.data.passLevels=[],e.data.money=0,e.data.toDayWatchAdCount=0,e.testMgr=new t.TestMgr},e.prototype.onDestroy=function(){var t=this;t.testMgr.dispose(),t.testMgr=null},e.prototype.startPlay=function(t){var e=this;t=t||e.getReachMaxLevel(),e.checkStage(t)&&e.testMgr.setCurTest(t)},e.prototype.checkStage=function(t){var e=this;return 1>t||t>200?!1:e.canStartLevel(t)},e.prototype.nextTest=function(){var t=this,e=t.testMgr.curTest.level;t.isFirstPassLevel(e)&&t.data.passLevels.push(e),t.testMgr.setCurTest(e+1)},e.prototype.isFirstPassLevel=function(t){var e=this;return-1==e.data.passLevels.indexOf(t)},e.prototype.canStartLevel=function(t){var e=this;return 1==t?!0:-1!=e.data.passLevels.indexOf(t-1)},e.prototype.getReachMaxLevel=function(){var t=this,e=t.data.passLevels[t.data.passLevels.length-1]||0;return e+1},e.prototype.modifyGold=function(t){var e=this;t=t||0,0!=t&&(e.data.gold+=t,utils.EventDispatcher.getInstance().dispatchEvent("goldChanged"))},e.prototype.costGold=function(t){var e=this;0>=t||e.data.gold<t||e.modifyGold(-t)},e.prototype.checkGoldEnough=function(t){var e=this;return e.data.gold>=t},e.prototype.modifyMoney=function(t){var e=this;t=t||0,0!=t&&(e.data.money+=t,utils.EventDispatcher.getInstance().dispatchEvent("moneyChanged"))},e.prototype.draw=function(){var t=this;return t.drawOnce()},e.prototype.drawOnce=function(){for(var e=t.GameCfg.getCfg().LotteryCfg,n=0,o=0;o<e.length;o++)n+=e[o].weight;for(var i,r=Math.random()*n,o=0;o<e.length;o++){var s=e[o];if(!(s.weight<=0)){if(r<=s.weight){i=s;break}r-=s.weight}}return i},e.prototype.drawTest=function(e){for(var n=this,o={},i=0;e>i;i++){var r=n.drawOnce();o[r.idx]?o[r.idx]++:o[r.idx]=1}console.log("抽奖"+e+"次的结果如下:");for(var i=0;i<t.GameCfg.getCfg().LotteryCfg.length;i++)o[i]&&console.log("奖品"+i+":"+(o[i]||0)+"次")},e}();t.GameMgr=e,__reflect(e.prototype,"guess.GameMgr",["utils.ISingleton"])}(guess||(guess={}));var guess;!function(t){var e=function(){function e(){}return e.prototype.dispose=function(){},e.prototype.setCurTest=function(t){var e=this;e.curTest=e.getTestInfo(t)},e.prototype.getTestInfo=function(e){return t.GameCfg.getTestInfo(e)},e.prototype.checkAnswer=function(t){var e=this;if(!e.curTest)return!1;var n=t===e.curTest.answer;return n},e}();t.TestMgr=e,__reflect(e.prototype,"guess.TestMgr")}(guess||(guess={}));var guess;!function(t){var e=function(){function t(){}return t.prototype.onCreate=function(){},t.prototype.onDestroy=function(){},t.prototype.watchAd=function(t,e){var n=this;return n.adEnable?void t():void e("广告不可用！")},Object.defineProperty(t.prototype,"adEnable",{get:function(){return!1},enumerable:!0,configurable:!0}),t}();t.AdMgr=e,__reflect(e.prototype,"guess.AdMgr",["utils.ISingleton"])}(guess||(guess={}));var guess;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this);var t=this;t.btnClose.removeClickListener(t.onClose,t)},n.prototype.initUI=function(){var t=this;t.contentPane=fairygui.UIPackage.createObject("guess","CashWindow").asCom},n.prototype.onInit=function(){var t=this;t.txtTip=t.contentPane.getChild("txtTip").asTextField,t.btnClose=t.contentPane.getChild("btnClose").asButton,t.btnClose.addClickListener(t.onClose,t)},n.prototype.initData=function(){var e=this,n=utils.Singleton.get(t.GameMgr).data.money;n>=t.GameCfg.getCfg().CashNeedMoney?e.txtTip.text="添加客服微信："+t.GameCfg.getCfg().OfficialWeChat+"，即可提现。":e.txtTip.text="需要达到"+t.GameCfg.getCfg().CashNeedMoney+"元才可提现哦~"},n.prototype.onClose=function(t){var e=this;e.hide()},n}(t.BaseWindow);t.CashWindow=e,__reflect(e.prototype,"guess.CashWindow")}(guess||(guess={}));var guess;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this);var t=this;t.btnDraw.removeClickListener(t.onBtnDrawClick,t),t.btnClose.removeClickListener(t.onBtnClose,t)},n.prototype.initUI=function(){var t=this;t.contentPane=fairygui.UIPackage.createObject("guess","DrawWindow").asCom},n.prototype.registerComponents=function(){},n.prototype.onInit=function(){var t=this;t.btnDraw=t.contentPane.getChild("btnDraw").asButton,t.btnDraw.addClickListener(t.onBtnDrawClick,t),t.btnClose=t.contentPane.getChild("btnClose").asButton,t.btnClose.addClickListener(t.onBtnClose,t),t.wheel=t.contentPane.getChild("wheel").asCom},n.prototype.onBtnDrawClick=function(e){var n=this;if(!n.isDraw){var o=utils.Singleton.get(t.GameMgr).draw();console.log("恭喜，抽到："+(o.gifts.money?"红包":"金币")+" x"+(o.gifts.money||o.gifts.gold)),utils.Singleton.get(t.GameMgr).modifyGold(o.gifts.gold),utils.Singleton.get(t.GameMgr).modifyMoney(o.gifts.money);var i=t.GameCfg.getCfg().LotteryCfg.length,r=360/i,s=5,a=[o.idx*r+s,(o.idx+1)*r-s],l=Math.floor(a[0]+Math.random()*(a[1]-a[0])),c=10,u=360*c+l;n.isDraw=!0,n.btnClose.enabled=!1,n.btnDraw.enabled=!1,egret.Tween.get(n.wheel).set({rotation:n.wheel.rotation%=360}).to({rotation:u-720},4e3,egret.Ease.sineIn).to({rotation:u},3e3,egret.Ease.sineOut).call(function(){n.isDraw=!1,n.btnClose.enabled=!0,n.btnDraw.enabled=!0})}},n.prototype.initData=function(t){var e=this;e.wheel.rotation=0},n.prototype.onBtnClose=function(t){var e=this;e.isDraw||(e.hide(),egret.Tween.removeTweens(e.wheel))},n}(t.BaseWindow);t.DrawWindow=e,__reflect(e.prototype,"guess.DrawWindow")}(guess||(guess={}));var guess;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this);var t=this;t.btnShare.removeClickListener(t.onbtnShare,t),t.btnClose.removeClickListener(t.onClose,t)},n.prototype.initUI=function(){var t=this;t.contentPane=fairygui.UIPackage.createObject("guess","FirstShareGroupWindow").asCom},n.prototype.onInit=function(){var t=this;t.btnShare=t.contentPane.getChild("btnShare").asButton,t.btnShare.addClickListener(t.onbtnShare,t),t.btnClose=t.contentPane.getChild("btnClose").asButton,t.btnClose.addClickListener(t.onClose,t),t.txtGold=t.contentPane.getChild("txtGold").asTextField},n.prototype.initData=function(){var e=this;e.txtGold.text="+"+t.GameCfg.getCfg().FirstShareGroupGold+"金币"},n.prototype.onbtnShare=function(t){var e=this;utils.EventDispatcher.getInstance().dispatchEvent("shareGroupOk"),e.hide()},n.prototype.onClose=function(t){var e=this;e.hide()},n}(t.BaseWindow);t.FirstShareGroupWindow=e,__reflect(e.prototype,"guess.FirstShareGroupWindow")}(guess||(guess={}));var guess;!function(t){var e=function(){function t(){}return t.getCfg=function(){return t.cfg||(t.cfg=RES.getRes("guessConfig_json")),t.cfg},t.getTestCfg=function(){return t.testCfg||(t.testCfg=RES.getRes("testConfig_json")),t.testCfg},t.getTestInfo=function(e){return t.getTestCfg()[e-1]||null},t.cfg=null,t.testCfg=null,t}();t.GameCfg=e,__reflect(e.prototype,"guess.GameCfg")}(guess||(guess={}));var guess;!function(t){var e=function(e){function n(t,o){var i=e.call(this,t,o)||this;return n.instance=i,i}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this);var t=this;t.btnStart.removeClickListener(t.onBtnStart,t),t.btnStage.removeClickListener(t.onBtnStage,t),t.btnRedBag.removeClickListener(t.onBtnRedBag,t),t.btnDraw.removeClickListener(t.onBtnDraw,t),utils.EventDispatcher.getInstance().removeEventListener("startStage",t.onStartStage,t),utils.EventDispatcher.getInstance().removeEventListener("onClickStartBtn",t.onBtnStart,t)},n.prototype.addEventListeners=function(){e.prototype.addEventListeners.call(this);var t=this;utils.EventDispatcher.getInstance().addEventListener("startStage",t.onStartStage,t)},n.prototype.registerComponents=function(){},n.prototype.onInit=function(){e.prototype.onInit.call(this);var t=this,n=platform instanceof DebugPlatform?!0:!1;utils.EventDispatcher.getInstance().addEventListener("onClickStartBtn",t.onBtnStart,t),t.scopeCtrl=t.contentPane.getController("scopeCtrl"),t.scopeCtrl.setSelectedIndex(n||Main.isScopeUserInfo?1:0),t.btnStart=t.contentPane.getChild("btnStart").asButton,t.btnStart.visible=n,t.btnStart.addClickListener(t.onBtnStart,t),t.btnStage=t.contentPane.getChild("btnStage").asButton,t.btnStage.addClickListener(t.onBtnStage,t),t.btnRedBag=t.contentPane.getChild("btnRedBag").asButton,t.btnRedBag.addClickListener(t.onBtnRedBag,t),t.btnDraw=t.contentPane.getChild("btnDraw").asButton,t.btnDraw.addClickListener(t.onBtnDraw,t)},n.prototype.onBtnStart=function(t){var e=this;e.scopeCtrl.setSelectedIndex(1),e.startPlay()},n.prototype.onBtnStage=function(t){var e=this;e.showStageWindow()},n.prototype.onBtnRedBag=function(t){var e=this;e.showRedBagWindow()},n.prototype.onBtnDraw=function(t){var e=this;e.showDrawWindow()},n.prototype.showStageWindow=function(){var e=this;e.stageWnd||(e.stageWnd=new t.StageWindow("guess")),e.stageWnd.show(),e.stageWnd.initData(!0)},n.prototype.onStartStage=function(t){var e=this;e.startPlay(t)},n.prototype.startPlay=function(e){var n=this;utils.Singleton.get(t.GameMgr).startPlay(e),n.showTestWindow()},n.prototype.showTestWindow=function(){var e=this;e.testWnd||(e.testWnd=new t.TestWindow("guess")),e.testWnd.show(),e.testWnd.initData()},n.prototype.showRedBagWindow=function(e,n){var o=this;o.redbag||(o.redbag=new t.RedBagWindow("guess")),o.redbag.show(),o.redbag.initData(e||utils.Singleton.get(t.GameMgr).data.money,n||"您当前共有红包")},n.prototype.showDrawWindow=function(){var e=this;e.drawWnd||(e.drawWnd=new t.DrawWindow("guess")),e.drawWnd.show(),e.drawWnd.initData({})},n}(t.BaseWindow);t.MainWindow=e,__reflect(e.prototype,"guess.MainWindow")}(guess||(guess={}));var guess;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.constructFromResource=function(){t.prototype.constructFromResource.call(this);var e=this;e.tip1=e.getChild("tip1"),e.tip2=e.getChild("tip2"),e.tip3=e.getChild("tip3"),e.tip4=e.getChild("tip4")},e.prototype.initTest=function(t){var e=this;return t?(e.tip1.initInfo("1",t.tips[0]),e.tip2.initInfo("2",t.tips[1]),e.tip3.initInfo("3",t.tips[2]),void e.tip4.initInfo("4",t.tips[3])):(e.tip1.initInfo("1","题库已答完~"),e.tip2.initInfo("2"),e.tip3.initInfo("3"),void e.tip4.initInfo("4"))},e}(fairygui.GComponent);t.QuestionPanel=e,__reflect(e.prototype,"guess.QuestionPanel")}(guess||(guess={}));var guess;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.constructFromResource=function(){t.prototype.constructFromResource.call(this);var e=this;e.txtDMTip1=e.getChild("txtDMTip1").asTextField,e.txtDMTip2=e.getChild("txtDMTip2").asTextField,e.txtDMTip3=e.getChild("txtDMTip3").asTextField},e.prototype.initTest=function(t){var e=this;return t?(e.txtDMTip1.text=""+t.tips[0],e.txtDMTip2.text=""+t.tips[1],void(e.txtDMTip3.text=""+t.tips[2])):(e.txtDMTip1.text="题库已答完~",e.txtDMTip2.text="",void(e.txtDMTip3.text=""))},e}(fairygui.GComponent);t.QuestionPanelDM=e,__reflect(e.prototype,"guess.QuestionPanelDM")}(guess||(guess={}));var guess;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this);var t=this;t.btnContact.removeClickListener(t.onContaceClick,t),t.btnClose.removeClickListener(t.onBtnClose,t),t.btnDraw.removeClickListener(t.onBtnDraw,t)},n.prototype.initUI=function(){var t=this;t.contentPane=fairygui.UIPackage.createObject("guess","RedBagWindow").asCom},n.prototype.registerComponents=function(){var e=this;e.registerComponent("TipItem",t.TipItem,"guess"),e.registerComponent("WordItem",t.WordItem,"guess")},n.prototype.onInit=function(){var t=this;t.txtMoney=t.contentPane.getChild("txtMoney").asTextField,t.txtTip=t.contentPane.getChild("txtTip").asTextField,t.txtTitle=t.contentPane.getChild("txtTitle").asTextField,t.btnContact=t.contentPane.getChild("btnContact").asButton,t.btnContact.addClickListener(t.onContaceClick,t),t.btnClose=t.contentPane.getChild("btnClose").asButton,t.btnClose.addClickListener(t.onBtnClose,t),t.btnDraw=t.contentPane.getChild("btnDraw").asButton,t.btnDraw.addClickListener(t.onBtnDraw,t)},n.prototype.onContaceClick=function(e){var n=this;n.cashWnd||(n.cashWnd=new t.CashWindow),n.cashWnd.show(),n.cashWnd.initData()},n.prototype.initData=function(e,n){var o=this;o.txtMoney.text=""+utils.Singleton.get(t.GameMgr).data.money,o.txtTitle.text=n,o.txtTip.text="满"+t.GameCfg.getCfg().CashNeedMoney+"元可以提现"},n.prototype.onBtnDraw=function(e){var n=this;n.hide(),t.MainWindow.instance.showDrawWindow()},n.prototype.onBtnClose=function(t){var e=this;e.hide()},n.prototype.onBtnStage=function(e){t.MainWindow.instance.showStageWindow()},n}(t.BaseWindow);t.RedBagWindow=e,__reflect(e.prototype,"guess.RedBagWindow")}(guess||(guess={}));var guess;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this);var t=this;t.btnNext.removeClickListener(t.onBtnNext,t),t.btnInvite.removeClickListener(t.onBtnInv,t)},n.prototype.initUI=function(){var t=this;t.contentPane=fairygui.UIPackage.createObject("guess","ResultWindow").asCom},n.prototype.registerComponents=function(){var e=this;e.registerComponent("TipItem",t.TipItem,"guess"),e.registerComponent("WordItem",t.WordItem,"guess")},n.prototype.onInit=function(){var t=this;t.btnNext=t.contentPane.getChild("btnNext").asButton,t.btnNext.addClickListener(t.onBtnNext,t),t.btnInvite=t.contentPane.getChild("btnInvite").asButton,t.btnInvite.addClickListener(t.onBtnInv,t),t.rankPre=t.contentPane.getChild("rankPre").asCom,t.rankMe=t.contentPane.getChild("rankMe").asCom,t.rankNxt=t.contentPane.getChild("rankNxt").asCom,t.txtGold=t.contentPane.getChild("txtGold").asTextField,t.txtTip=t.contentPane.getChild("txtTip").asTextField},n.prototype.onShown=function(){},n.prototype.initData=function(t){var e=this;e.txtGold.text="+"+t+"金币",e.txtTip.text=0>=t?"(已答对的题不再获得)":""},n.prototype.onBtnNext=function(t){var e=this;e.hide(),utils.EventDispatcher.getInstance().dispatchEvent("onNextTest")},n.prototype.onBtnInv=function(t){},n}(t.BaseWindow);t.ResultWindow=e,__reflect(e.prototype,"guess.ResultWindow")}(guess||(guess={}));var guess;!function(t){var e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return __extends(n,e),n.prototype.constructFromResource=function(){e.prototype.constructFromResource.call(this);var t=this;t.txtLv=t.getChild("txtLv").asTextField,t.lockCtrl=t.getController("lockCtrl"),t.hasRedbagCtrl=t.getController("hasRedbagCtrl")},n.prototype.initInfo=function(e,n){var o=this;o.level=e,o.txtLv.text=e+"";var i=t.GameCfg.getTestInfo(o.level);o.lockCtrl.setSelectedIndex(n||!i?1:0),o.hasRedbagCtrl.setSelectedIndex(i&&i.money>=0?1:0)},n}(fairygui.GComponent);t.StageItem=e,__reflect(e.prototype,"guess.StageItem")}(guess||(guess={}));var guess;!function(t){var e=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.pageIdx=0,t}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this);var t=this;t.btnClose.removeClickListener(t.onBtnClose,t),t.btnPre.addClickListener(t.onBtnPre,t),t.btnNext.addClickListener(t.onBtnNext,t),t.lstLevel.removeEventListener(fairygui.ItemEvent.CLICK,t.onLevelLstClick,t)},n.prototype.initUI=function(){var t=this;t.contentPane=fairygui.UIPackage.createObject("guess","StageWindow").asCom},n.prototype.registerComponents=function(){var e=this;e.registerComponent("StageItem",t.StageItem,"guess")},n.prototype.onInit=function(){var t=this;t.btnClose=t.contentPane.getChild("btnClose").asButton,t.btnClose.addClickListener(t.onBtnClose,t),t.btnPre=t.contentPane.getChild("btnPre").asButton,t.btnPre.addClickListener(t.onBtnPre,t),t.btnNext=t.contentPane.getChild("btnNext").asButton,t.btnNext.addClickListener(t.onBtnNext,t),t.lstLevel=t.contentPane.getChild("lstLevel").asList,t.lstLevel.addEventListener(fairygui.ItemEvent.CLICK,t.onLevelLstClick,t),t.txtRank=t.contentPane.getChild("txtRank").asTextField},n.prototype.onLevelLstClick=function(e){var n=this,o=e.itemObject;return utils.Singleton.get(t.GameMgr).canStartLevel(o.level)?(utils.EventDispatcher.getInstance().dispatchEvent("startStage",o.level),void n.hide()):console.log("请先通过上一关！")},n.prototype.prePage=function(){var t=this;t.btnNext.enabled=!0,t.pageIdx--,t.initData()},n.prototype.nextPage=function(){var t=this;t.btnPre.enabled=!0,t.pageIdx++,t.initData()},n.prototype.initData=function(e){var n=this;e&&(n.pageIdx=0);for(var o=utils.Singleton.get(t.GameMgr).getReachMaxLevel(),i=n.pageIdx||Math.floor(o/20),r=20*i+1,s=0,a=n.lstLevel.numItems;a>s;s++){var l=n.lstLevel.getChildAt(s);l.initInfo(r,r>o),r++}n.txtRank.text=n.getRankDesc(o),n.setPageBtnState()},n.prototype.setPageBtnState=function(){var t=this;t.pageIdx<=0&&(t.pageIdx=0,t.btnPre.enabled=!1),t.pageIdx>=9&&(t.pageIdx=9,t.btnNext.enabled=!1)},n.prototype.getRankDesc=function(t){var e=t/40,n="小学生";e>1&&(n="中等生"),e>2&&(n="优等生"),e>3&&(n="学霸"),e>4&&(n="超级学霸");var o=Math.ceil(t%40/10),i=""+n+o+"星";return i},n.prototype.onBtnClose=function(t){var e=this;e.hide()},n.prototype.onBtnPre=function(t){var e=this;e.prePage()},n.prototype.onBtnNext=function(t){var e=this;e.nextPage()},n}(t.BaseWindow);t.StageWindow=e,__reflect(e.prototype,"guess.StageWindow")}(guess||(guess={}));var guess;!function(t){var e=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.isFillAnswer=!1,t}return __extends(n,e),n.prototype.dispose=function(){e.prototype.dispose.call(this);var t=this;t.btnBack.removeClickListener(t.onBtnBack,t),t.btnStage.removeClickListener(t.onBtnStage,t),t.btnRedBag.removeClickListener(t.onBtnRedBag,t),t.btnUnlock.removeClickListener(t.onBtnUnlock,t),t.lstSelect.removeEventListener(fairygui.ItemEvent.CLICK,t.onSelectLstClick,t),t.lstOption.removeEventListener(fairygui.ItemEvent.CLICK,t.onOptionLstClick,t),t.goldComp.removeClickListener(t.onClickGold,t),utils.EventDispatcher.getInstance().removeEventListener("goldChanged",t.refreshGold,t)},n.prototype.initUI=function(){var t=this;t.contentPane=fairygui.UIPackage.createObject("guess","TestWindow").asCom},n.prototype.registerComponents=function(){var e=this;e.registerComponent("TipItem",t.TipItem,"guess"),e.registerComponent("WordItem",t.WordItem,"guess"),e.registerComponent("WordItemSmall",t.WordItemSmall,"guess"),e.registerComponent("QuestionPanel",t.QuestionPanel,"guess"),e.registerComponent("QuestionPanelDM",t.QuestionPanelDM,"guess")},n.prototype.onInit=function(){var t=this;t.questionPanel=t.contentPane.getChild("questionPanel"),t.questionPanelDM=t.contentPane.getChild("questionPanelDM"),t.goldComp=t.contentPane.getChild("goldComp").asCom,t.txtGold=t.goldComp.getChild("txtGold").asTextField,t.goldComp.addClickListener(t.onClickGold,t),t.btnBack=t.contentPane.getChild("btnBack").asButton,t.btnStage=t.contentPane.getChild("btnStage").asButton,t.btnRedBag=t.contentPane.getChild("btnRedBag").asButton,t.btnUnlock=t.contentPane.getChild("btnUnlock").asButton,t.btnBack.addClickListener(t.onBtnBack,t),t.btnStage.addClickListener(t.onBtnStage,t),t.btnRedBag.addClickListener(t.onBtnRedBag,t),t.btnUnlock.addClickListener(t.onBtnUnlock,t),t.lstSelect=t.contentPane.getChild("lstSelect").asList,t.lstOption=t.contentPane.getChild("lstOption").asList,t.lstSelect.addEventListener(fairygui.ItemEvent.CLICK,t.onSelectLstClick,t),t.lstOption.addEventListener(fairygui.ItemEvent.CLICK,t.onOptionLstClick,t),utils.EventDispatcher.getInstance().addEventListener("goldChanged",t.refreshGold,t),t.wrongTip=t.contentPane.getChild("wrongTip").asCom,t.txtLevel=t.contentPane.getChild("txtLevel").asTextField},n.prototype.onSelectLstClick=function(t){var e=this,n=t.itemObject;if(!n.isEmpty()){var o=n.word;n.setChar("");for(var i=0;i<e.lstOption.numItems;i++){var r=e.lstOption.getChildAt(i);if(r.word===o){r.setChar(o);break}}e.isFillAnswer=!1}},n.prototype.onOptionLstClick=function(t){var e=this;if(!e.isFillAnswer){var n=t.itemObject;if(!n.isEmpty()){n.hide();for(var o=0;o<e.lstSelect.numItems;o++){var i=e.lstSelect.getChildAt(o);if(i.isEmpty()){i.setChar(n.word);break}}e.checkAnswer()}}},n.prototype.checkAnswer=function(){var e=this,n="";e.isFillAnswer=!0;for(var o=0;o<e.lstSelect.numItems;o++){var i=e.lstSelect.getChildAt(o);if(n+=i.word,i.isEmpty())return void(e.isFillAnswer=!1)}var r=utils.Singleton.get(t.GameMgr),s=r.testMgr.checkAnswer(n);if(s){var a=0,l=r.isFirstPassLevel(r.testMgr.curTest.level);l&&(a=t.GameCfg.getCfg().TestRewardGold,r.modifyGold(a),r.modifyMoney(r.testMgr.curTest.money)),e.resultWnd||(e.resultWnd=new t.ResultWindow("guess")),e.resultWnd.show(),e.resultWnd.initData(a),l&&r.testMgr.curTest.money>0&&t.MainWindow.instance.showRedBagWindow(r.testMgr.curTest.money,"恭喜您获得红包"),utils.EventDispatcher.getInstance().once("onNextTest",function(){e.nextTest()},e)}else e.wrongTip.visible=!0,egret.Tween.get(e.wrongTip).set({alpha:0}).to({alpha:1},500,egret.Ease.sineInOut).wait(500).to({alpha:0},500,egret.Ease.sineInOut).call(function(){e.wrongTip.visible=!1})},n.prototype.onShown=function(){},n.prototype.nextTest=function(){var e=this;utils.Singleton.get(t.GameMgr).nextTest(),e.initData()},n.prototype.initData=function(){var e=this;e.refreshGold();var n=utils.Singleton.get(t.GameMgr).testMgr.curTest;e.questionPanelDM.initTest(n),e.questionPanel.initTest(n),e.initTest(n),e.txtLevel.text=n?"第 "+n.level+" 关":"没有题目"},n.prototype.refreshGold=function(){var e=this;e.txtGold.text=""+utils.Singleton.get(t.GameMgr).data.gold},n.prototype.initTest=function(t){var e=this;if(e.lstOption.removeChildrenToPool(0,e.lstOption.numItems-1),e.lstSelect.removeChildrenToPool(0,e.lstSelect.numItems-1),t){e.isFillAnswer=!1;for(var n=t.option.split(","),o=0,i=n.length;i>o;o++){var r=e.lstOption.addItemFromPool(fairygui.UIPackage.getItemURL("guess","WordItem"));r.setChar(n[o])}for(var o=0;o<t.answer.length;o++){var r=e.lstSelect.addItemFromPool(fairygui.UIPackage.getItemURL("guess","WordItemSmall"));r.setChar("")}}},n.prototype.onBtnBack=function(t){var e=this;e.hide(),Main.userInfoBtn.show()},n.prototype.onBtnStage=function(e){t.MainWindow.instance.showStageWindow()},n.prototype.onBtnRedBag=function(e){t.MainWindow.instance.showRedBagWindow()},n.prototype.onBtnUnlock=function(e){var n=this,o=utils.Singleton.get(t.GameMgr).testMgr.curTest;if(o){var i=t.GameCfg.getCfg().UnlockAnswerCost;if(!utils.Singleton.get(t.GameMgr).checkGoldEnough(i))return n.lackWnd||(n.lackWnd=new t.LackGoldWindow("guess")),n.lackWnd.show(),n.lackWnd.initData(),utils.EventDispatcher.getInstance().removeEventListener("watchAdOk",n.showAnswerTip,n),utils.EventDispatcher.getInstance().once("watchAdOk",n.showAnswerTip,n),utils.EventDispatcher.getInstance().removeEventListener("shareGroupOk",n.showAnswerTip,n),void utils.EventDispatcher.getInstance().once("shareGroupOk",n.showAnswerTip,n);utils.Singleton.get(t.GameMgr).costGold(i),n.showAnswerTip()}},n.prototype.showAnswerTip=function(){for(var e=this,n=utils.Singleton.get(t.GameMgr).testMgr.curTest.answer,o=0,i=e.lstOption.numItems;i>o;o++){var r=e.lstOption.getChildAt(o);-1!=n.indexOf(r.word)&&r.showColorAni()}},n.prototype.onClickGold=function(e){var n=this,o=!0;
if(o){var i=new t.FirstShareGroupWindow;i.show(),i.initData(),utils.EventDispatcher.getInstance().removeEventListener("shareGroupOk",n.onShareOk,n),utils.EventDispatcher.getInstance().once("shareGroupOk",n.onShareOk,n)}},n.prototype.onShareOk=function(){utils.Singleton.get(t.GameMgr).modifyGold(t.GameCfg.getCfg().FirstShareGroupGold)},n}(t.BaseWindow);t.TestWindow=e,__reflect(e.prototype,"guess.TestWindow")}(guess||(guess={}));var guess;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.constructFromResource=function(){t.prototype.constructFromResource.call(this);var e=this;e.txtId=e.getChild("txtId").asTextField,e.txtDesc=e.getChild("txtDesc").asTextField},e.prototype.initInfo=function(t,e){void 0===e&&(e="");var n=this;n.txtId.text=t,n.txtDesc.text=e},e}(fairygui.GComponent);t.TipItem=e,__reflect(e.prototype,"guess.TipItem")}(guess||(guess={}));var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var guess;!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e}(t.WordItem);t.WordItemSmall=e,__reflect(e.prototype,"guess.WordItemSmall")}(guess||(guess={})),window.Main=Main;